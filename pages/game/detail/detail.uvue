<template>
	<view class="container">
		<view class="header">
			<text class="title">{{ gameName }}</text>
		</view>
		<view class="game-cover-container">
			<view class="game-cover">
				<text class="cover-emoji">{{ gameEmoji }}</text>
			</view>
		</view>
		<view class="game-info">
			<text class="game-description">{{ gameDescription }}</text>
		</view>
		<view class="button-container">
			<view class="start-button" @click="startGame">
				<text class="button-text">ğŸ¯ å¼€å§‹æ¸¸æˆ</text>
			</view>
		</view>
	</view>
</template>

<script lang="uts">
	export default {
		data() {
			return {
				gameId: "",
				gameName: "",
				gameEmoji: "ğŸ®",
				gameDescription: "å‡†å¤‡å¥½å¼€å§‹æ¸¸æˆäº†å—ï¼Ÿ"
			}
		},
		onLoad(options: OnLoadOptions) {
			const id = options["id"]
			const name = options["name"]
			const emoji = options["emoji"]
			const description = options["description"]
			
			console.log('onLoad - Raw id:', id)
			console.log('onLoad - Raw name:', name)
			
			if (id != null) {
				this.gameId = id.trim()
				console.log('Set gameId to:', this.gameId, 'length:', this.gameId.length)
			}
			if (name != null) {
				try {
					const decodedName = decodeURIComponent(name as string)
					if (decodedName != null) {
						this.gameName = decodedName.trim()
						console.log('Set gameName to:', this.gameName, 'length:', this.gameName.length)
					}
				} catch (e) {
					// å¦‚æœè§£ç å¤±è´¥ï¼Œç›´æ¥ä½¿ç”¨åŸå§‹å€¼
					this.gameName = name.trim()
					console.log('Decode failed, use raw name:', this.gameName)
				}
			}
			if (emoji != null) {
				const decodedEmoji = decodeURIComponent(emoji as string)
				if (decodedEmoji != null) {
					this.gameEmoji = decodedEmoji
				}
			}
			if (description != null) {
				const decodedDesc = decodeURIComponent(description as string)
				if (decodedDesc != null) {
					this.gameDescription = decodedDesc
				}
			}
		},
		methods: {
			startGame() {
				// æ ¹æ®æ¸¸æˆIDæˆ–æ¸¸æˆåç§°è·³è½¬åˆ°å¯¹åº”çš„æ¸¸æˆé¡µé¢
				console.log('gameId:', this.gameId, 'gameName:', this.gameName)
				console.log('gameId type:', typeof this.gameId, 'gameId length:', this.gameId.length)
				console.log('gameName type:', typeof this.gameName, 'gameName length:', this.gameName.length)
				console.log('gameId === "1":', this.gameId === "1")
				console.log('gameName === "èˆ’å°”ç‰¹æ–¹æ ¼":', this.gameName === "èˆ’å°”ç‰¹æ–¹æ ¼")
				
				// ä½¿ç”¨æ›´å®½æ¾çš„åŒ¹é…æ¡ä»¶
				const gameIdMatch = this.gameId === "1" || this.gameName.includes("1")
				const gameNameMatch = this.gameName === "èˆ’å°”ç‰¹æ–¹æ ¼" || this.gameName.includes("èˆ’å°”ç‰¹")
				
				console.log('gameIdMatch:', gameIdMatch, 'gameNameMatch:', gameNameMatch)
				
				if (gameIdMatch || gameNameMatch) {
					console.log(this.gameName + ' æ¸¸æˆå¯åŠ¨!')
					// èˆ’å°”ç‰¹æ–¹æ ¼
					uni.navigateTo({
						url: '/pages/game/schulte/schulte'
					})
				} else {
					console.log('æ¡ä»¶ä¸åŒ¹é…ï¼Œæ˜¾ç¤ºæç¤º')
					uni.showToast({
						title: 'æ¸¸æˆå³å°†å¼€å§‹ï¼',
						icon: 'success',
						duration: 2000
					})
				}
			}
		}
	}
</script>

<style>
	.container {
		flex: 1;
		background: linear-gradient(135deg, #A8E6CF 0%, #D4F1F4 100%);
		padding: 20px;
	}
	
	.header {
		margin-top: 40px;
		margin-bottom: 30px;
	}
	
	.title {
		font-size: 36px;
		font-weight: bold;
		color: #4ECDC4;
		text-align: center;
		text-shadow: 2px 2px 0px #FFFFFF, 4px 4px 0px rgba(0,0,0,0.1);
	}
	
	.game-cover-container {
		align-items: center;
		justify-content: center;
		margin: 30px 0;
	}
	
	.game-cover {
		width: 200px;
		height: 200px;
		background: linear-gradient(135deg, #FFE5B4 0%, #FFCCCB 100%);
		border-radius: 20px;
		border: 4px solid #FFFFFF;
		box-shadow: 0px 8px 0px rgba(0,0,0,0.15), 0px 4px 0px rgba(0,0,0,0.1);
		align-items: center;
		justify-content: center;
	}
	
	.cover-emoji {
		font-size: 100px;
	}
	
	.game-info {
		margin: 30px 20px;
		padding: 20px;
		background: rgba(255, 255, 255, 0.7);
		border-radius: 15px;
		border: 3px solid #FFFFFF;
		box-shadow: 0px 4px 0px rgba(0,0,0,0.1);
	}
	
	.game-description {
		font-size: 18px;
		color: #4ECDC4;
		text-align: center;
		line-height: 28px;
		font-weight: bold;
	}
	
	.button-container {
		margin-top: 40px;
		align-items: center;
		justify-content: center;
	}
	
	.start-button {
		width: 280px;
		height: 70px;
		background: linear-gradient(135deg, #FF6B6B 0%, #FF8E8E 100%);
		border-radius: 20px;
		border: 4px solid #FFFFFF;
		box-shadow: 0px 8px 0px rgba(0,0,0,0.2), 0px 4px 0px rgba(0,0,0,0.15);
		align-items: center;
		justify-content: center;
	}
	
	.start-button:active {
		transform: translateY(2px);
		box-shadow: 0px 4px 0px rgba(0,0,0,0.15), 0px 2px 0px rgba(0,0,0,0.1);
	}
	
	.button-text {
		font-size: 24px;
		font-weight: bold;
		color: #FFFFFF;
		text-shadow: 2px 2px 0px rgba(0,0,0,0.2);
	}
</style>
