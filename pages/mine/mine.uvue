<template>
	<view class="container" @click="closeAddMenu">
		<view class="header">
			<text class="title">ğŸ‘¤ æˆ‘çš„</text>
			<!-- å³ä¸Šè§’+æŒ‰é’® -->
			<view class="header-add-button" v-if="isLoggedIn" @click.stop="toggleAddMenu">
				<text class="add-icon">+</text>
			</view>
			<!-- ä¸‹æ‹‰èœå• -->
			<view class="add-menu" v-if="isLoggedIn && showAddMenu" @click.stop>
				<view class="menu-item" @click="goToAddChild">
					<text class="menu-item-text">æ·»åŠ å­å¥³</text>
				</view>
				<view class="menu-item" @click="goToFamilyManagement">
					<text class="menu-item-text">å®¶åº­ç®¡ç†</text>
				</view>
			</view>
		</view>
		<!-- å¤´åƒä¸ç™»å½• -->
		<view class="profile-section">
			<view class="avatar-wrapper">
				<image class="avatar" :src="avatarUrl" mode="aspectFill"></image>
			</view>
			<!-- æœªç™»å½•æ—¶æ˜¾ç¤ºç™»å½•æŒ‰é’® -->
			<view class="auth-button" v-if="!isLoggedIn" @click="openAuthDialog">
				<text class="auth-button-text">æ³¨å†Œ / ç™»é™†</text>
			</view>
			<!-- å·²ç™»å½•æ—¶æ˜¾ç¤ºæ‰‹æœºå· -->
			<view class="phone-number" v-if="isLoggedIn">
				<text class="phone-number-text">{{ authPhoneNumber }}</text>
			</view>
		</view>
		<!-- å­å¥³å¡ç‰‡ -->
		<view class="child-card-wrapper" v-if="isLoggedIn && currentChild != null">
			<view class="child-card">
				<view class="child-card-content">
					<view class="child-avatar-wrapper">
						<image class="child-avatar" :src="currentChild.avatar || avatarUrl" mode="aspectFill"></image>
					</view>
					<text class="child-name">{{ currentChild.child_name || 'å­©å­æ˜µç§°' }}</text>
					<view class="child-card-actions">
						<view class="child-action-button manage-button" @click="goToChildManagement">
							<text class="action-button-text">ç®¡ç†</text>
						</view>
						<view class="child-action-button switch-button" @click="openChildSelector">
							<text class="action-button-text">åˆ‡æ¢</text>
						</view>
					</view>
				</view>
			</view>
		</view>
		<view class="content">
			<view class="menu-list">
				<view class="menu-item" @click="handleMenuClick('æ¡£æ¡ˆ')">
					<text class="menu-icon">ğŸ“</text>
					<text class="menu-text">æ¡£æ¡ˆ</text>
				</view>
				<view class="menu-item" @click="handleMenuClick('å·¥å…·')">
					<text class="menu-icon">ğŸ”§</text>
					<text class="menu-text">å·¥å…·</text>
				</view>
				<view class="menu-item" @click="handleMenuClick('èµ„æº')">
					<text class="menu-icon">ğŸ“¦</text>
					<text class="menu-text">èµ„æº</text>
				</view>
				<view class="menu-item" @click="handleMenuClick('å¹¿å‘Š')">
					<text class="menu-icon">ğŸ“¢</text>
					<text class="menu-text">å¹¿å‘Š</text>
				</view>
				<view class="menu-item" @click="handleMenuClick('æèµ ')">
					<text class="menu-icon">ğŸ’</text>
					<text class="menu-text">æèµ </text>
				</view>
			</view>
		</view>
		
		<!-- é€€å‡ºè´¦å·æŒ‰é’® -->
		<view class="logout-section" v-if="isLoggedIn">
			<view class="logout-button" @click="handleLogout">
				<text class="logout-button-text">é€€å‡ºè´¦å·</text>
			</view>
		</view>

		<!-- æ³¨å†Œ/ç™»é™†å¼¹çª— -->
		<view class="dialog-mask" v-if="showAuthDialog" @click="closeAuthDialog">
			<view class="auth-dialog" @click.stop>
				<view class="auth-dialog-header">
					<text class="auth-dialog-title">æ³¨å†Œ / ç™»é™†</text>
					<view class="dialog-close" @click="closeAuthDialog">
						<text class="close-icon">âœ•</text>
					</view>
				</view>
				<view class="auth-dialog-content">
					<input class="auth-input" v-model="phoneNumber" placeholder="è¯·è¾“å…¥æ‰‹æœºå·" />
					<input class="auth-input" v-model="password" placeholder="è¯·è¾“å…¥å¯†ç " password />
					<view class="dialog-actions">
						<view class="dialog-button confirm-button" @click="submitAuth">
							<text class="dialog-button-text">ç¡®è®¤</text>
						</view>
					</view>
				</view>
			</view>
		</view>
		
		<!-- å­å¥³é€‰æ‹©å¼¹çª— -->
		<view class="dialog-mask" v-if="showChildSelector" @click="closeChildSelector">
			<view class="child-selector-dialog" @click.stop>
				<view class="child-selector-title">
					<text class="selector-title-text">é€‰æ‹©å­å¥³</text>
				</view>
				<view class="child-list">
					<view 
						class="child-selector-item" 
						v-for="(child, index) in childrenList" 
						:key="index"
						@click="selectChild(child)"
					>
						<view class="child-selector-avatar-wrapper">
							<image class="child-selector-avatar" :src="child.avatar || avatarUrl" mode="aspectFill"></image>
						</view>
						<text class="child-selector-name">{{ child.child_name || child.nickname || 'æœªå‘½å' }}</text>
						<text class="check-icon" v-if="isChildSelected(child)">âœ“</text>
					</view>
				</view>
				<view class="selector-actions">
					<view class="selector-button cancel-button" @click="closeChildSelector">
						<text class="selector-button-text">å–æ¶ˆ</text>
					</view>
					<view class="selector-button confirm-button" @click="confirmChildSelection">
						<text class="selector-button-text">ç¡®å®š</text>
					</view>
				</view>
			</view>
		</view>
	</view>
</template>

<script lang="uts">
	import { login, getChildrenList } from '../../utils/api.uts'
	
	type ChildInfo = {
		id?: string | number
		child_name?: string // API è¿”å›çš„å­—æ®µå
		nickname?: string // å…¼å®¹æ—§å­—æ®µå
		gender?: string | number
		age?: number
		grade?: string
		avatar?: string
		remark?: string
		relation_type?: number
	}
	
	export default {
		data() {
			return {
				avatarUrl: 'https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/unicloudlogo.png',
				showAuthDialog: false,
				phoneNumber: '',
				password: '',
				authToken: '',
				authPhoneNumber: '',
				showAddMenu: false,
				childrenList: [] as ChildInfo[],
				currentChild: null as ChildInfo | null,
				selectedChild: null as ChildInfo | null,
				showChildSelector: false
			}
		},
		computed: {
			isLoggedIn(): boolean {
				return this.authToken != null && this.authToken != '' && this.authPhoneNumber != null && this.authPhoneNumber != ''
			}
		},
		onLoad() {
			this.loadAuthInfo()
			// loadChildrenList å†…éƒ¨ä¼šè°ƒç”¨ loadCurrentChild
			this.loadChildrenList()
		},
		onShow() {
			// é¡µé¢æ˜¾ç¤ºæ—¶é‡æ–°åŠ è½½æ•°æ®
			// loadChildrenList å†…éƒ¨ä¼šè°ƒç”¨ loadCurrentChild
			this.loadChildrenList()
		},
		methods: {
			openAuthDialog() {
				this.showAuthDialog = true
			},
			closeAuthDialog() {
				this.showAuthDialog = false
			},
			submitAuth() {
				const name = this.phoneNumber.trim()
				const pwd = this.password.trim()
				if (name === '' || pwd === '') {
					uni.showToast({
						title: 'è¯·è¾“å…¥æ‰‹æœºå·å’Œå¯†ç ',
						icon: 'none'
					})
					return
				}
				uni.showLoading({
					title: 'ç™»é™†ä¸­...',
					mask: true
				})
				
				login(name, pwd, (res: any) => {
					uni.hideLoading()
					if (res.success) {
						// æ¸…é™¤æ—§è´¦å·çš„å­å¥³æ•°æ®
						this.childrenList = []
						this.currentChild = null
						this.selectedChild = null
						try {
							uni.removeStorageSync('childrenList')
							uni.removeStorageSync('currentChildId')
						} catch (e) {
							console.error('æ¸…é™¤æ—§æ•°æ®å¤±è´¥:', e)
						}
						
						this.authToken = res.token
						this.authPhoneNumber = name
						try {
							uni.setStorageSync('authToken', res.token)
							uni.setStorageSync('authPhoneNumber', name)
						} catch (e) {
							console.error('ä¿å­˜tokenå¤±è´¥:', e)
						}
						uni.showToast({
							title: res.message || 'ç™»å½•æˆåŠŸ',
							icon: 'success'
						})
						this.closeAuthDialog()
						// æ¸…ç©ºè¾“å…¥æ¡†
						this.phoneNumber = ''
						this.password = ''
						
						// é‡æ–°åŠ è½½æ–°è´¦å·çš„å­å¥³æ•°æ®
						this.loadChildrenList()
					} else {
						uni.showToast({
							title: res.message || 'ç™»å½•å¤±è´¥',
							icon: 'none'
						})
					}
				})
			},
		loadAuthInfo() {
			try {
				const token = uni.getStorageSync('authToken')
				const phone = uni.getStorageSync('authPhoneNumber')
				if (token != null && token != '' && phone != null && phone !== '') {
					const newPhone = phone.toString()
					const newToken = token.toString()
					
					// æ£€æµ‹è´¦å·æ˜¯å¦åˆ‡æ¢ï¼ˆæ‰‹æœºå·å˜åŒ–ï¼‰
					if (this.authPhoneNumber != null && this.authPhoneNumber !== '' && this.authPhoneNumber !== newPhone) {
						// è´¦å·å·²åˆ‡æ¢ï¼Œæ¸…é™¤æ—§è´¦å·çš„å­å¥³æ•°æ®
						this.childrenList = []
						this.currentChild = null
						this.selectedChild = null
						try {
							uni.removeStorageSync('childrenList')
							uni.removeStorageSync('currentChildId')
						} catch (e) {
							console.error('æ¸…é™¤æ—§è´¦å·æ•°æ®å¤±è´¥:', e)
						}
					}
					
					this.authToken = newToken
					this.authPhoneNumber = newPhone
				} else {
					// æœªç™»å½•çŠ¶æ€ï¼Œæ¸…é™¤æ•°æ®
					this.authToken = ''
					this.authPhoneNumber = ''
				}
			} catch (e) {
				console.error('åŠ è½½ç™»å½•ä¿¡æ¯å¤±è´¥:', e)
			}
		},
			handleLogout() {
				uni.showModal({
					title: 'æç¤º',
					content: 'ç¡®å®šè¦é€€å‡ºè´¦å·å—ï¼Ÿ',
					success: (res: any) => {
						if (res.confirm) {
							// æ¸…é™¤ç™»å½•ä¿¡æ¯
							this.authToken = ''
							this.authPhoneNumber = ''
							try {
								uni.removeStorageSync('authToken')
								uni.removeStorageSync('authPhoneNumber')
							} catch (e) {
								console.error('æ¸…é™¤ç™»å½•ä¿¡æ¯å¤±è´¥:', e)
							}
							
							// æ¸…é™¤å­å¥³æ•°æ®
							this.childrenList = []
							this.currentChild = null
							this.selectedChild = null
							try {
								uni.removeStorageSync('childrenList')
								uni.removeStorageSync('currentChildId')
							} catch (e) {
								console.error('æ¸…é™¤å­å¥³æ•°æ®å¤±è´¥:', e)
							}
							
							uni.showToast({
								title: 'å·²é€€å‡ºè´¦å·',
								icon: 'success'
							})
						}
					}
				})
			},
			handleMenuClick(menuName: string) {
				// æ ¹æ®èœå•åç§°æ‰§è¡Œç›¸åº”æ“ä½œ
				switch (menuName) {
					case 'æ¡£æ¡ˆ':
						uni.showToast({
							title: 'æ¡£æ¡ˆåŠŸèƒ½å¼€å‘ä¸­',
							icon: 'none',
							duration: 2000
						})
						break
					case 'å·¥å…·':
						uni.navigateTo({
							url: '/pages/mine/tools/tools'
						})
						break
					case 'èµ„æº':
						uni.showToast({
							title: 'èµ„æºåŠŸèƒ½å¼€å‘ä¸­',
							icon: 'none',
							duration: 2000
						})
						break
					case 'å¹¿å‘Š':
						uni.showToast({
							title: 'å¹¿å‘ŠåŠŸèƒ½å¼€å‘ä¸­',
							icon: 'none',
							duration: 2000
						})
						break
					case 'æèµ ':
						uni.showToast({
							title: 'æèµ åŠŸèƒ½å¼€å‘ä¸­',
							icon: 'none',
							duration: 2000
						})
						break
					default:
						break
				}
			},
			toggleAddMenu() {
				this.showAddMenu = !this.showAddMenu
			},
			closeAddMenu() {
				this.showAddMenu = false
			},
			goToAddChild() {
				this.showAddMenu = false
				uni.navigateTo({
					url: '/pages/mine/add-child'
				})
			},
			goToFamilyManagement() {
				this.showAddMenu = false
				uni.navigateTo({
					url: '/pages/mine/parent-management'
				})
			},
			goToChildManagement() {
				uni.navigateTo({
					url: '/pages/mine/child-management'
				})
			},
			openChildSelector() {
				if (this.childrenList.length === 0) {
					uni.showToast({
						title: 'æš‚æ— å­å¥³ï¼Œè¯·å…ˆæ·»åŠ ',
						icon: 'none'
					})
					return
				}
				this.selectedChild = this.currentChild
				this.showChildSelector = true
			},
			closeChildSelector() {
				this.showChildSelector = false
				this.selectedChild = null
			},
			selectChild(child: ChildInfo) {
				this.selectedChild = child
			},
			isChildSelected(child: ChildInfo): boolean {
				// å¦‚æœæœ‰é€‰ä¸­çš„å­å¥³ï¼Œæ£€æŸ¥æ˜¯å¦åŒ¹é…
				if (this.selectedChild != null && this.selectedChild.id != null && child.id != null) {
					return this.selectedChild.id.toString() === child.id.toString()
				}
				// å¦‚æœæ²¡æœ‰é€‰ä¸­çš„ï¼Œæ£€æŸ¥æ˜¯å¦æ˜¯å½“å‰å­å¥³
				if (this.currentChild != null && this.currentChild.id != null && child.id != null) {
					return this.currentChild.id.toString() === child.id.toString()
				}
				return false
			},
			confirmChildSelection() {
				if (this.selectedChild != null) {
					this.currentChild = this.selectedChild
					this.saveCurrentChild()
					uni.showToast({
						title: 'åˆ‡æ¢æˆåŠŸ',
						icon: 'success'
					})
				}
				this.closeChildSelector()
			},
			loadChildrenList() {
				// å¦‚æœæœªç™»å½•ï¼Œä»æœ¬åœ°å­˜å‚¨åŠ è½½
				if (!this.isLoggedIn) {
					try {
						const stored = uni.getStorageSync('childrenList')
						if (stored != null && stored !== '') {
							const parsed = JSON.parse(stored.toString())
							if (Array.isArray(parsed)) {
								this.childrenList = parsed as ChildInfo[]
							} else {
								this.childrenList = []
							}
						} else {
							this.childrenList = []
						}
					} catch (e) {
						console.error('åŠ è½½å­å¥³åˆ—è¡¨å¤±è´¥:', e)
						this.childrenList = []
					}
					// åŠ è½½å®Œå­å¥³åˆ—è¡¨åï¼Œæ›´æ–°å½“å‰å­å¥³
					this.loadCurrentChild()
					return
				}
				
				// å·²ç™»å½•æ—¶ï¼Œä»æœåŠ¡å™¨è·å–
				getChildrenList((result) => {
					if (result.success) {
						this.childrenList = result.data
						
						// åŒæ­¥æ›´æ–°æœ¬åœ°å­˜å‚¨ï¼ˆç”¨äºç¼“å­˜ï¼‰
						try {
							uni.setStorageSync('childrenList', JSON.stringify(result.data))
						} catch (e) {
							console.error('ä¿å­˜å­å¥³åˆ—è¡¨åˆ°æœ¬åœ°å­˜å‚¨å¤±è´¥:', e)
						}
					} else {
						// API å¤±è´¥æ—¶ï¼Œå°è¯•ä»æœ¬åœ°å­˜å‚¨åŠ è½½ï¼ˆé™çº§å¤„ç†ï¼‰
						try {
							const stored = uni.getStorageSync('childrenList')
							if (stored != null && stored !== '') {
								const parsed = JSON.parse(stored.toString())
								if (Array.isArray(parsed)) {
									this.childrenList = parsed as ChildInfo[]
								} else {
									this.childrenList = []
								}
							} else {
								this.childrenList = []
							}
						} catch (e) {
							console.error('ä»æœ¬åœ°å­˜å‚¨åŠ è½½å­å¥³åˆ—è¡¨å¤±è´¥:', e)
							this.childrenList = []
						}
					}
					
					// åŠ è½½å®Œå­å¥³åˆ—è¡¨åï¼Œæ›´æ–°å½“å‰å­å¥³
					this.loadCurrentChild()
				})
			},
			saveChildrenList() {
				try {
					uni.setStorageSync('childrenList', JSON.stringify(this.childrenList))
				} catch (e) {
					console.error('ä¿å­˜å­å¥³åˆ—è¡¨å¤±è´¥:', e)
				}
			},
			loadCurrentChild() {
				try {
					// å¦‚æœå­å¥³åˆ—è¡¨ä¸ºç©ºï¼Œæ¸…é™¤å½“å‰å­å¥³
					if (this.childrenList.length === 0) {
						this.currentChild = null
						this.saveCurrentChild()
						return
					}
					
					const stored = uni.getStorageSync('currentChildId')
					if (stored != null && stored !== '') {
						const childId = stored.toString()
						for (let i = 0; i < this.childrenList.length; i++) {
							const child = this.childrenList[i]
							if (child.id != null && child.id.toString() === childId) {
								this.currentChild = child
								break
							}
						}
						// å¦‚æœæ‰¾ä¸åˆ°ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ª
						if (this.currentChild == null && this.childrenList.length > 0) {
							this.currentChild = this.childrenList[0]
							this.saveCurrentChild()
						}
					} else if (this.childrenList.length > 0) {
						// å¦‚æœæ²¡æœ‰ä¿å­˜çš„ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ª
						this.currentChild = this.childrenList[0]
						this.saveCurrentChild()
					}
				} catch (e) {
					console.error('åŠ è½½å½“å‰å­å¥³å¤±è´¥:', e)
				}
			},
			saveCurrentChild() {
				try {
					if (this.currentChild != null && this.currentChild.id != null) {
						uni.setStorageSync('currentChildId', this.currentChild.id.toString())
					} else {
						uni.removeStorageSync('currentChildId')
					}
				} catch (e) {
					console.error('ä¿å­˜å½“å‰å­å¥³å¤±è´¥:', e)
				}
			}
		}
	}
</script>

<style>
	.container {
		flex: 1;
		background-color: #FFB5E8;
		padding: 20px;
	}
	
	.header {
		margin-top: 40px;
		margin-bottom: 30px;
	}
	
	.profile-section {
		align-items: center;
		margin-bottom: 20px;
	}
	
	.avatar-wrapper {
		width: 120px;
		height: 120px;
		border-radius: 60px;
		overflow: hidden;
		border: 4px solid #FFFFFF;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
		margin-bottom: 12px;
		background-color: #FFFFFF;
	}
	
	.avatar {
		width: 100%;
		height: 100%;
	}
	
	.auth-button {
		padding: 10px 20px;
		background-color: #F368E0;
		border-radius: 20px;
		border: 2px solid #FFFFFF;
		box-shadow: 0 3px 10px rgba(243, 104, 224, 0.25);
	}
	
	.auth-button:active {
		opacity: 0.9;
	}
	
	.auth-button-text {
		font-size: 16px;
		color: #FFFFFF;
		font-weight: bold;
	}
	
	.phone-number {
		margin-top: 8px;
		padding: 8px 16px;
		background-color: #FFFFFF;
		border-radius: 20px;
		border: 2px solid #F368E0;
	}
	
	.phone-number-text {
		font-size: 16px;
		color: #F368E0;
		font-weight: bold;
	}
	
	.title {
		font-size: 32px;
		font-weight: bold;
		color: #FFFFFF;
		text-align: center;
		background-color: #F368E0;
		padding: 8px 16px;
		border-radius: 8px;
		border: 2px solid #FFFFFF;
	}
	
	.content {
		flex: 1;
		padding: 20px;
	}
	
	.menu-list {
		width: 100%;
		align-items: center;
	}
	
	.menu-item {
		width: 100%;
		height: 70px;
		background-color: #FFFFFF;
		border-radius: 15px;
		border: 3px solid #FFFFFF;
		border-bottom-width: 8px;
		border-bottom-color: #E0E0E0;
		margin-bottom: 15px;
		flex-direction: row;
		align-items: center;
		justify-content: center;
	}
	
	.menu-item:active {
		background-color: #F5F5F5;
		border-bottom-width: 4px;
	}
	
	.menu-icon {
		font-size: 28px;
		margin-right: 15px;
	}
	
	.menu-text {
		font-size: 20px;
		font-weight: bold;
		color: #F368E0;
	}

	/* å¼¹çª—æ ·å¼ */
	.dialog-mask {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background-color: rgba(0, 0, 0, 0.5);
		align-items: center;
		justify-content: center;
		z-index: 999;
	}
	
	.auth-dialog {
		width: 90%;
		max-width: 480px;
		background-color: #FFFFFF;
		border-radius: 16px;
		overflow: hidden;
	}
	
	.auth-dialog-header {
		flex-direction: row;
		align-items: center;
		justify-content: space-between;
		padding: 16px 18px;
		border-bottom-width: 1px;
		border-bottom-color: #F0F0F0;
		border-bottom-style: solid;
	}
	
	.auth-dialog-title {
		font-size: 18px;
		font-weight: bold;
		color: #333333;
	}
	
	.dialog-close {
		width: 30px;
		height: 30px;
		align-items: center;
		justify-content: center;
	}
	
	.close-icon {
		font-size: 18px;
		color: #999999;
	}
	
	.auth-dialog-content {
		padding: 18px;
	}
	
	.auth-input {
		width: 100%;
		height: 44px;
		border-width: 1px;
		border-color: #E0E0E0;
		border-style: solid;
		border-radius: 10px;
		padding: 10px 12px;
		font-size: 14px;
		color: #333333;
		margin-bottom: 12px;
		background-color: #FAFAFA;
	}
	
	.dialog-actions {
		margin-top: 10px;
	}
	
	.dialog-button {
		width: 100%;
		background-color: #F368E0;
		border-radius: 10px;
		padding: 12px 0;
		align-items: center;
		justify-content: center;
	}
	
	.dialog-button:active {
		background-color: #e35acb;
	}
	
	.dialog-button-text {
		font-size: 16px;
		color: #FFFFFF;
		font-weight: bold;
	}
	
	/* é€€å‡ºè´¦å·æŒ‰é’®æ ·å¼ */
	.logout-section {
		width: 100%;
		padding: 20px;
		align-items: center;
	}
	
	.logout-button {
		width: 100%;
		padding: 12px 20px;
		background-color: #FF6B6B;
		border-radius: 20px;
		border: 2px solid #FFFFFF;
		box-shadow: 0 3px 10px rgba(255, 107, 107, 0.25);
		align-items: center;
		justify-content: center;
	}
	
	.logout-button:active {
		opacity: 0.9;
		background-color: #ff5252;
	}
	
	.logout-button-text {
		font-size: 16px;
		color: #FFFFFF;
		font-weight: bold;
	}
	
	/* å³ä¸Šè§’+æŒ‰é’®æ ·å¼ */
	.header {
		position: relative;
		flex-direction: row;
		align-items: center;
		justify-content: center;
		z-index: 1000;
	}
	
	.header-add-button {
		position: absolute;
		right: 0;
		width: 40px;
		height: 40px;
		background-color: #F368E0;
		border-radius: 20px;
		align-items: center;
		justify-content: center;
		border: 2px solid #FFFFFF;
		z-index: 1001;
	}
	
	.header-add-button:active {
		opacity: 0.8;
	}
	
	.add-icon {
		font-size: 28px;
		color: #FFFFFF;
		font-weight: bold;
		line-height: 28px;
	}
	
	/* ä¸‹æ‹‰èœå•æ ·å¼ */
	.add-menu {
		position: fixed;
		top: 90px;
		right: 20px;
		width: 140px;
		background-color: #FFFFFF;
		border-radius: 10px;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
		overflow: hidden;
		z-index: 1002;
	}
	
	.menu-item {
		padding: 12px 16px;
		border-bottom-width: 1px;
		border-bottom-color: #F0F0F0;
		border-bottom-style: solid;
	}
	
	.menu-item:last-child {
		border-bottom-width: 0;
	}
	
	.menu-item:active {
		background-color: #F5F5F5;
	}
	
	.menu-item-text {
		font-size: 14px;
		color: #333333;
	}
	
	/* å­å¥³å¡ç‰‡æ ·å¼ */
	.child-card-wrapper {
		width: 100%;
		padding: 0 20px;
		margin-bottom: 15px;
	}
	
	.child-card {
		width: 100%;
		background-color: #FFFFFF;
		border-radius: 15px;
		padding: 16px;
		border: 3px solid #FFFFFF;
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
	}
	
	.child-card-content {
		flex-direction: row;
		align-items: center;
	}
	
	.child-avatar-wrapper {
		width: 60px;
		height: 60px;
		border-radius: 30px;
		overflow: hidden;
		border: 2px solid #F368E0;
		margin-right: 12px;
		background-color: #F5F5F5;
	}
	
	.child-avatar {
		width: 100%;
		height: 100%;
	}
	
	.child-name {
		font-size: 18px;
		font-weight: bold;
		color: #F368E0;
		flex: 1;
	}
	
	.child-card-actions {
		flex-direction: row;
		align-items: center;
		gap: 8px;
		margin-left: 12px;
	}
	
	.child-action-button {
		padding: 8px 20px;
		border-radius: 10px;
		align-items: center;
		justify-content: center;
		min-width: 60px;
	}
	
	.manage-button {
		background-color: #F368E0;
	}
	
	.switch-button {
		background-color: #4CAF50;
	}
	
	.child-action-button:active {
		opacity: 0.8;
	}
	
	.action-button-text {
		font-size: 14px;
		color: #FFFFFF;
		font-weight: bold;
	}
	
	/* å­å¥³é€‰æ‹©å¼¹çª—æ ·å¼ */
	.child-selector-dialog {
		width: 90%;
		max-width: 400px;
		background-color: #FFFFFF;
		border-radius: 16px;
		overflow: hidden;
	}
	
	.child-selector-title {
		padding: 16px;
		border-bottom-width: 1px;
		border-bottom-color: #F0F0F0;
		border-bottom-style: solid;
		align-items: center;
		justify-content: center;
	}
	
	.selector-title-text {
		font-size: 18px;
		font-weight: bold;
		color: #333333;
	}
	
	.child-list {
		max-height: 400px;
		padding: 12px;
	}
	
	.child-selector-item {
		flex-direction: row;
		align-items: center;
		padding: 12px;
		border-radius: 10px;
		margin-bottom: 8px;
		background-color: #F9F9F9;
	}
	
	.child-selector-item:active {
		background-color: #F0F0F0;
	}
	
	.child-selector-avatar-wrapper {
		width: 50px;
		height: 50px;
		border-radius: 25px;
		overflow: hidden;
		border: 2px solid #4CAF50;
		margin-right: 12px;
		background-color: #F5F5F5;
	}
	
	.child-selector-avatar {
		width: 100%;
		height: 100%;
	}
	
	.child-selector-name {
		font-size: 16px;
		color: #333333;
		flex: 1;
	}
	
	.check-icon {
		font-size: 20px;
		color: #4CAF50;
		font-weight: bold;
		margin-left: 8px;
	}
	
	.selector-actions {
		flex-direction: row;
		border-top-width: 1px;
		border-top-color: #F0F0F0;
		border-top-style: solid;
	}
	
	.selector-button {
		flex: 1;
		padding: 14px 0;
		align-items: center;
		justify-content: center;
	}
	
	.cancel-button {
		background-color: #F5F5F5;
		border-right-width: 1px;
		border-right-color: #F0F0F0;
		border-right-style: solid;
	}
	
	.selector-button:active {
		opacity: 0.8;
	}
	
	.selector-button-text {
		font-size: 16px;
		color: #333333;
		font-weight: bold;
	}
	
	.confirm-button .selector-button-text {
		color: #4CAF50;
	}
</style>
